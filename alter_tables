/* alters MODEL table to add MOD_WAIT_CHG attribute */
use Ch08_AviaCo;
ALTER TABLE MODEL
ADD MOD_WAIT_CHG numeric;

/* updates MODEL table to change MOD_WAIT_CHG depending on MOD_CODE */
UPDATE MODEL
SET MOD_WAIT_CHG=100
WHERE (MOD_CODE='C-90A');

UPDATE MODEL
SET MOD_WAIT_CHG=50
WHERE (MOD_CODE='PA23-250');

UPDATE MODEL
SET MOD_WAIT_CHG=75
WHERE (MOD_CODE='PA31-350');
SELECT * FROM MODEL;


/* alters CHARTER table to add multiple attributes */
ALTER TABLE CHARTER
ADD CHAR_WAIT_CHG numeric,
	CHAR_FLT_CHG_HR numeric,
	CHAR_FLT_CHG numeric,
	CHAR_TAX_CHG numeric,
	CHAR_TOT_CHG numeric,
	CHAR_PYMT numeric,
	CHAR_BALANCE numeric;
SELECT * FROM CHARTER;


/* creates view from MODEL table and AIRCRAFT table where MOD_CODE is the same */
CREATE VIEW MOD_CHG AS
SELECT AIRCRAFT.AC_NUMBER, MODEL.MOD_WAIT_CHG
FROM AIRCRAFT, MODEL
WHERE AIRCRAFT.MOD_CODE = MODEL.MOD_CODE;

SELECT * FROM MOD_CHG;


/* updates CHAR_WAIT_CHG in CHARTER table from MOD_WAIT_CHG from MODEL table */
USE Ch08_AviaCo;
UPDATE CHARTER
/* uses previously created view MOD_CHG */
SET CHAR_WAIT_CHG = (SELECT MOD_WAIT_CHG FROM MOD_CHG 
			WHERE MOD_CHG.AC_NUMBER = CHARTER.AC_NUMBER);
SELECT * FROM CHARTER;


/* updates CHAR_FLT_CHG in CHARTER table */
UPDATE CHARTER
SET CHAR_FLT_CHG=CHAR_HOURS_FLOWN*(SELECT MOD_CHG_MILE FROM MODEL
				WHERE MODEL.MOD_CODE=(SELECT MOD_CODE FROM AIRCRAFT
				WHERE AIRCRAFT.AC_NUMBER=CHARTER.AC_NUMBER));
SELECT * FROM CHARTER;


/* updates CHAR_TAX_CHG in CHARTER table */
USE Ch08_AviaCo;
UPDATE CHARTER
SET CHAR_TAX_CHG = CHAR_FLT_CHG * .08
WHERE CHAR_FLT_CHG != 0;
SELECT * FROM CHARTER;


